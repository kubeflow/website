[build]
  publish = "public"
  # setting baseURL is required for `PAGE.Permalink` to correctly include the full `https://DOMAIN/` prefix
  # which is required for things like `twitter:image` meta tags to work correctly
  command = "cd themes/docsy && git submodule update -f --init && npm install && cd ../.. && hugo --gc --minify"

[context.deploy-preview]
  # for deploy previews, the domain will be `https://deploy-preview-PR_NUMBER--competent-brattain-de2d6d.netlify.app/`
  # which can be read from the `DEPLOY_PRIME_URL` environment variable in Netlify
  command = "cd themes/docsy && git submodule update -f --init && npm install && cd ../.. && hugo --gc --minify --baseURL $DEPLOY_PRIME_URL"

[context.production]
  # for production, the domain will be `https://www.kubeflow.org/`
  command = "cd themes/docsy && git submodule update -f --init && npm install && cd ../.. && hugo --gc --minify --baseURL https://www.kubeflow.org/"

[[context.deploy-preview.plugins]]
package = "netlify-plugin-checklinks"

  [context.deploy-preview.plugins.inputs]

  # If a link contains these patterns it will be ignored.
  skipPatterns = [
    # ignore absolute links, which are only found in tags like `<meta property="og:url" content="URL_HERE">`
    # https://github.com/Munter/netlify-plugin-checklinks/issues/388
    "competent-brattain-de2d6d.netlify.app",
  ]

  # If a link contains these patterns it will not fail the build, but will be reported as a TODO in the build log.
  todoPatterns = [
    "public/docs/components/central-dash/",
    "public/docs/components/notebooks/",

    "public/docs/components/pipelines/",
    "public/docs/gke/pipelines/authentication-pipelines",
    "public/docs/gke/pipelines/upgrade",

    "public/docs/components/katib/",
    "public/docs/components/kfserving/",
    "public/docs/components/training/",

    "public/docs/distributions/gke/",
    "public/docs/gke/deploy/oauth-setup",

    "public/docs/distributions/aws/",
    "public/docs/distributions/ibm/",

    "public/fonts/glyphicons",
    "public/docs/experiment",
    "public/docs/suggestion",
    "public/docs/trial",
    "public/docs/examples/shared-resources",
    "public/docs/started/getting-started",
    "public/docs/other-guides",
    "public/docs/external-add-ons/istio",
  ]

[context.deploy-preview.environment]
  HUGO_ENV = "development"
  HUGO_VERSION = "0.124.1"
  NODE_VERSION = "18"

[context.production.environment]
  HUGO_ENV = "production"
  HUGO_VERSION = "0.124.1"
  NODE_VERSION = "18"

[context.branch-deploy.environment]
  HUGO_ENV = "development"
  HUGO_VERSION = "0.124.1"
  NODE_VERSION = "18"